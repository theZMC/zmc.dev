---
import BaseLayout from "@layouts/BaseLayout.astro";
import PostList from "@components/PostList.astro";
import type { MarkdownInstance } from 'astro';

const pageTitle = "ZMC.DEV";

let posts: MarkdownInstance<Record<string, any>>[];
let projects: MarkdownInstance<Record<string, any>>[];

try {
	posts = await Astro.glob("../pages/posts/*.md");
	posts = posts.sort((a, b) => {
		return new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime();
	});
} catch (e) {
	posts = [];
}

try {
  projects = await Astro.glob("../pages/projects/*.md");
  projects = projects.sort((a, b) => {
    return new Date(b.frontmatter.pubDate).getTime() - new Date(a.frontmatter.pubDate).getTime();
  });
} catch (e) {
  projects = [];
}
---

<BaseLayout pageTitle={pageTitle} isIndex={true}>
  <article>
    <p>
      Hey! I'm Zach. I'm a full-stack developer, kubernetes evangelist, and open-source enthusiast.
      <a href="mailto:zach@zmc.dev">Get in touch with me</a> if you think I can help you with your next project.
    </p>
		{
			posts.length > 0 && (
				<h3>Recent Posts</h3>
				<PostList posts={posts} qty={3} />
				<a href="/posts">View all posts &rarr;</a>
			)
		}
  </article>
</BaseLayout>

<style>
  article > a {
    font-weight: 400;
    text-transform: uppercase;
    font-size: 0.8rem;
  }
  h3 {
    margin-top: 1rem;
    text-transform: uppercase;
    font-weight: 300;
  }
  p {
    background: #ffffff55;
    padding: 1rem;
    border-radius: 0.5rem;
  }
</style>
